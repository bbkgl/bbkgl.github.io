---
layout:     post
title:      程序中栈帧的分布
subtitle:   profile
date:       2019-12-03
author:     bbkgl
header-img: img/post-bg-0008.jpg
catalog: true
tags:
    - profile
---

>千磨万击还坚劲
>
>任尔东西南北风 

## 函数调用

函数调用就是就是一层一层递进的执行某些功能（动作），在这个过程中，考虑到每个函数执行结束后还要返回，必然会留下很多信息，而计算机也需要存储这些信息。举个例子，A()中调用了B()，那B()执行结束后怎么知道返回A呢，以及A中定义的那些局部变量呢？为了存储这些信息，则计算机给每个即将执行或正在执行的函数分配了一个调用过程中存储信息的空间，就叫栈帧（没参考别人，我瞎说的）。

## 栈帧

如下图是一个x86机器的栈帧结构：

![](https://originlee.com/images/blog-stack_frame.png)

因为现在大家都用的64位的机器，所以结合下面这个结构理解会更好一点：

```cpp
           High
        |   ...   |
        +---------+
     +24|  Arg 1  |
        +---------+
     +16|  Arg 2  |
        +---------+
     + 8| Return  |
        +---------+
EBP+--> |Saved EBP|
        +---------+
     - 8|  Var 1  |
        +---------+
ESP+--> |  Var 2  |
        +---------+
        |   ...   |
            Low
```

EBP对应64位中寄存器中RBP，同理ESP对应64位中寄存器中RSP。


